<!DOCTYPE html>
<html>
<head>
   <meta charset="utf-8">

   <title>WebSocket Test</title>
   <script src="http://www.codebase.es/riffwave/riffwave.js"></script>
   <script src="https://cdn.socket.io/socket.io-1.2.0.js"></script>
   <script language="javascript" type="text/javascript">
volume = 0.5;
var play = function(freq) {
   var audio = new Audio(); // Create the HTML5 audio element
   var wave = new RIFFWAVE();
   var data = [];

   wave.header.sampleRate = 44100; // Set sample rate to 44KHz
   wave.header.numChannels = 1;

   var i = 0;
   while (i < 10000) {
var t = i / wave.header.sampleRate;
data[i++] = 128 + Math.round(127 * Math.sin(freq * t * 2 * Math.PI));
   }

   wave.Make(data);
   audio.src = wave.dataURI;
   audio.volume = volume;
   audio.play();
}

var wsUri = location.origin.replace(/^http/, 'ws');
var socket = io(wsUri);

socket.on('connect', function() {
   console.log("connection");
});
socket.on('error', function() {
   console.error("error");
});
socket.on('tweet', function(t) {
   play(t.tone);
});
   </script>
</head>

<body>
   <h2>WebSocket Test</h2>
</body>
</html>